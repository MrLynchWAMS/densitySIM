<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Density Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            /* Allow vertical scrolling while preventing horizontal scroll */
            overflow-y: auto;
            overflow-x: hidden;
            touch-action: manipulation; /* Changed from 'none' to allow scrolling on touch devices */
        }
        .grab { cursor: grab; }
        .grabbing { 
            cursor: grabbing;
            z-index: 1000;
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        .graduated-cylinder {
            width: 100px;
            height: 350px;
            border: 4px solid #9ca3af;
            border-top: none;
            border-radius: 0 0 20px 20px;
            position: relative;
            background-color: #f0f9ff;
            overflow: hidden;
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.1);
        }
        .water {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #60a5fa;
            opacity: 0.7;
            transition: height 0.5s ease;
            border-top: 2px solid #3b82f6;
        }
        .graduated-cylinder::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-image: 
                repeating-linear-gradient(to top, #9ca3af, #9ca3af 1px, transparent 1px, transparent 14px), /* 5mL lines */
                repeating-linear-gradient(to top, #6b7280, #6b7280 1px, transparent 1px, transparent 70px); /* 25mL lines */
            background-size: 10px 100%, 20px 100%;
            background-position: right, right;
            background-repeat: no-repeat;
        }
        .scale-plate {
            width: 200px;
            height: 15px;
            background-color: #cbd5e1;
            border-radius: 4px 4px 0 0;
            border: 2px solid #9ca3af;
            border-bottom: none;
        }
        .scale-body {
            width: 220px;
            height: 80px;
            background-color: #e2e8f0;
            border-radius: 8px;
            padding: 8px;
            border: 2px solid #9ca3af;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .scale-screen {
            background-color: #052e16; /* Dark green */
            color: #6ee7b7; /* Bright green */
            font-family: monospace;
            font-size: 24px;
            text-align: right;
            padding: 8px;
            border-radius: 4px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.5);
        }
        /* Style for input fields to provide feedback */
        input.border-green-500 { border-color: #22c55e; }
        input.border-red-500 { border-color: #ef4444; }
    </style>
</head>
<body class="bg-slate-100 text-slate-800">

    <div id="app" class="min-h-screen p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-slate-900">Interactive Density Lab</h1>
            <p class="text-lg text-slate-600 mt-2">Measure mass and volume to calculate the density of various substances!</p>
        </header>

        <!-- Main container for layout -->
        <main class="flex flex-col lg:flex-row gap-8">

            <!-- Left Section: Lab Simulation -->
            <section id="lab-space" class="w-full lg:w-1/2 bg-white p-6 rounded-2xl shadow-lg">
                <h2 class="text-2xl font-bold mb-4">Lab Bench</h2>
                <div id="lab-bench" class="relative min-h-[500px] flex flex-col md:flex-row justify-around items-end gap-8 p-4 border-2 border-slate-200 rounded-lg bg-slate-50">
                    
                    <!-- Graduated Cylinder Area -->
                    <div class="flex flex-col items-center">
                        <div class="flex items-end">
                             <div id="graduated-cylinder" class="graduated-cylinder">
                                <div id="water" class="water"></div>
                            </div>
                            <!-- Labels for Graduated Cylinder -->
                            <div class="text-xs text-slate-500 h-[350px] flex flex-col justify-between ml-1 py-1">
                                <span>100mL</span><span>75mL</span><span>50mL</span><span>25mL</span><span>0mL</span>
                            </div>
                        </div>
                       <p class="font-semibold mt-2">Volume: <span id="volume-readout" class="font-mono text-blue-600">50.0</span> mL</p>
                       <div id="overflow-warning" class="hidden text-red-600 font-bold mt-2">OVERFLOW!</div>
                    </div>

                    <!-- Scale Area -->
                    <div class="flex flex-col items-center">
                        <div id="scale-plate" class="scale-plate"></div>
                        <div class="scale-body">
                             <div id="scale-screen" class="scale-screen">0.00 g</div>
                        </div>
                    </div>
                </div>

                <div id="objects-container" class="mt-6">
                     <h3 class="text-xl font-semibold mb-3">Objects</h3>
                     <p class="text-sm text-slate-500 mb-4">Drag an object to the scale to find its mass, or to the cylinder to find its volume by displacement.</p>
                     <div id="object-palette" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 p-4 bg-slate-50 border-2 border-slate-200 rounded-lg">
                         <!-- Objects will be dynamically inserted here -->
                     </div>
                </div>
            </section>

            <!-- Right Section: Lab Results -->
            <section class="w-full lg:w-1/2 bg-white p-6 rounded-2xl shadow-lg">
                <h2 class="text-2xl font-bold mb-4">Lab Results</h2>
                
                <!-- Known Substances Table -->
                <div class="mb-8">
                    <h3 class="text-xl font-semibold mb-3">1. Find the Density of Known Substances</h3>
                    <div class="overflow-x-auto">
                        <table id="known-results" class="w-full text-sm text-left text-slate-500">
                            <thead class="text-xs text-slate-700 uppercase bg-slate-100">
                                <tr>
                                    <th scope="col" class="px-4 py-3">Substance</th>
                                    <th scope="col" class="px-4 py-3">Mass (g)</th>
                                    <th scope="col" class="px-4 py-3">Volume (mL)</th>
                                    <th scope="col" class="px-4 py-3">Calculated Density (g/mL)</th>
                                </tr>
                            </thead>
                            <tbody id="known-results-body">
                                <!-- Rows will be dynamically inserted here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Mystery Objects Table -->
                <div>
                    <h3 class="text-xl font-semibold mb-3">2. Identify Mystery Objects</h3>
                     <div class="overflow-x-auto">
                        <table id="mystery-results" class="w-full text-sm text-left text-slate-500">
                            <thead class="text-xs text-slate-700 uppercase bg-slate-100">
                                <tr>
                                    <th scope="col" class="px-4 py-3">Object</th>
                                    <th scope="col" class="px-4 py-3">Mass (g)</th>
                                    <th scope="col" class="px-4 py-3">Volume (mL)</th>
                                    <th scope="col" class="px-4 py-3">Your Calculated Density</th>
                                    <th scope="col" class="px-4 py-3">What is it?</th>
                                    <th scope="col" class="px-4 py-3">Result</th>
                                </tr>
                            </thead>
                            <tbody id="mystery-results-body">
                                <!-- Rows will be dynamically inserted here -->
                            </tbody>
                        </table>
                    </div>
                    <div class="mt-4 flex justify-end">
                        <button id="check-answers-btn" class="px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors">Check My Answers</button>
                    </div>
                </div>

            </section>
        </main>
    </div>

<script>
    document.addEventListener('DOMContentLoaded', () => {

        // --- DOM ELEMENT REFERENCES ---
        const labBench = document.getElementById('lab-bench');
        const objectPalette = document.getElementById('object-palette');
        const scaleScreen = document.getElementById('scale-screen');
        const graduatedCylinder = document.getElementById('graduated-cylinder');
        const waterEl = document.getElementById('water');
        const volumeReadout = document.getElementById('volume-readout');
        const overflowWarning = document.getElementById('overflow-warning');
        const knownResultsBody = document.getElementById('known-results-body');
        const mysteryResultsBody = document.getElementById('mystery-results-body');
        const checkAnswersBtn = document.getElementById('check-answers-btn');

        // --- DATA & STATE ---
        const knownSubstances = [
            { id: 'wood', name: 'Wood', mass: 35, volume: 50, color: 'bg-yellow-800' },
            { id: 'aluminum', name: 'Aluminum', mass: 54, volume: 20, color: 'bg-slate-400' },
            { id: 'ice', name: 'Ice', mass: 46, volume: 50, color: 'bg-blue-200' },
            { id: 'gold', name: 'Gold', mass: 193, volume: 10, color: 'bg-yellow-400' }
        ];

        const mysteryObjects = [
            { id: 'a', name: 'Diamond', mass: 70.4, volume: 20, color: 'bg-cyan-200' },
            { id: 'b', name: 'Quartz', mass: 53.0, volume: 20, color: 'bg-pink-200' },
            { id: 'c', name: 'Iron', mass: 157.4, volume: 20, color: 'bg-gray-600' }
        ];
        
        // Calculate densities for checking answers later
        mysteryObjects.forEach(obj => obj.density = obj.mass / obj.volume);

        let draggedElement = null;
        let initialWaterLevel = 50.0; // mL
        const cylinderCapacity = 100.0; // mL
        const waterHeightPerML = 3.5; // px per mL, calibrated to the 350px cylinder height

        // --- INITIALIZATION ---
        function init() {
            // Populate objects
            [...knownSubstances, ...mysteryObjects].forEach(createObject);

            // Populate tables
            knownSubstances.forEach(substance => createTableRow(substance, knownResultsBody, false));
            mysteryObjects.forEach(obj => createTableRow(obj, mysteryResultsBody, true));

            setupEventListeners();
            updateWaterLevel(0); // Set initial water level
        }

        // --- DOM CREATION ---
        function createObject(obj) {
            const el = document.createElement('div');
            el.id = `obj-${obj.id}`;
            el.className = `draggable grab w-16 h-16 rounded-lg flex items-center justify-center text-white font-bold shadow-md transition-transform ${obj.color}`;
            el.textContent = obj.name.startsWith('Mystery') ? obj.id.toUpperCase() : obj.name;
            el.dataset.id = obj.id;
            objectPalette.appendChild(el);
        }
        
        function createTableRow(obj, tableBody, isMystery) {
            const row = document.createElement('tr');
            row.id = `${isMystery ? 'mystery' : 'known'}-${obj.id}`;
            row.className = 'bg-white border-b';

            const objectName = isMystery ? `Mystery ${obj.id.toUpperCase()}` : obj.name;
            let rowHTML = `
                <th scope="row" class="px-4 py-3 font-medium text-gray-900 whitespace-nowrap">${objectName}</th>
                <td class="px-4 py-3 mass-cell"></td>
                <td class="px-4 py-3 volume-cell"></td>
            `;

            if (isMystery) {
                rowHTML += `
                    <td class="px-4 py-3"><input type="number" class="w-24 p-1 border rounded density-input bg-slate-50" placeholder="0.00"></td>
                    <td class="px-4 py-3"><input type="text" class="w-24 p-1 border rounded substance-input bg-slate-50" placeholder="Substance"></td>
                    <td class="px-4 py-3 result-cell"></td>
                `;
            } else {
                 rowHTML += `<td class="px-4 py-3 density-cell"></td>`;
            }
            row.innerHTML = rowHTML;
            tableBody.appendChild(row);
        }

        // --- EVENT LISTENERS ---
        function setupEventListeners() {
            document.addEventListener('mousedown', startDrag);
            document.addEventListener('touchstart', startDrag, { passive: false });

            document.addEventListener('mousemove', drag);
            document.addEventListener('touchmove', drag, { passive: false });

            document.addEventListener('mouseup', endDrag);
            document.addEventListener('touchend', endDrag);
            
            checkAnswersBtn.addEventListener('click', checkMysteryAnswers);
        }

        // --- DRAG & DROP LOGIC ---
        function startDrag(e) {
            if (e.target.classList.contains('draggable')) {
                e.preventDefault();
                draggedElement = e.target;
                draggedElement.classList.add('grabbing');
                
                // Position the element for dragging
                const rect = draggedElement.getBoundingClientRect();
                draggedElement.style.position = 'absolute';
                draggedElement.style.left = `${rect.left}px`;
                draggedElement.style.top = `${rect.top}px`;
            }
        }

        function drag(e) {
            if (!draggedElement) return;
            e.preventDefault();
            const touch = e.touches ? e.touches[0] : e;
            draggedElement.style.left = `${touch.clientX - draggedElement.offsetWidth / 2}px`;
            draggedElement.style.top = `${touch.clientY - draggedElement.offsetHeight / 2}px`;
        }

        function endDrag() {
            if (!draggedElement) return;
            
            const elementId = draggedElement.dataset.id;
            const substance = [...knownSubstances, ...mysteryObjects].find(s => s.id === elementId);

            if (isOver(draggedElement, scaleScreen)) {
                // Drop on scale
                updateScale(substance.mass);
                updateTableMass(substance);
            } else {
                updateScale(0); // Clear scale if not dropped on it
            }

            if (isOver(draggedElement, graduatedCylinder)) {
                // Drop in cylinder
                updateWaterLevel(substance.volume);
                updateTableVolume(substance);
            } else {
                updateWaterLevel(0); // Reset water level
            }
            
            // Reset object position and style
            draggedElement.classList.remove('grabbing');
            draggedElement.style.position = 'static';
            draggedElement.style.left = '';
            draggedElement.style.top = '';
            objectPalette.appendChild(draggedElement); // Return to palette

            draggedElement = null;
        }

        function isOver(el1, el2) {
            const rect1 = el1.getBoundingClientRect();
            const rect2 = el2.getBoundingClientRect();
            return !(rect1.right < rect2.left || rect1.left > rect2.right || rect1.bottom < rect2.top || rect1.top > rect2.bottom);
        }

        // --- UI & DATA UPDATES ---
        function updateScale(mass) {
            scaleScreen.textContent = `${mass.toFixed(2)} g`;
        }

        function updateWaterLevel(displacedVolume) {
            const newTotalVolume = initialWaterLevel + displacedVolume;
            const isOverflowing = newTotalVolume > cylinderCapacity;
            
            waterEl.classList.toggle('overflow', isOverflowing);
            overflowWarning.classList.toggle('hidden', !isOverflowing);

            const height = Math.min(350, newTotalVolume * waterHeightPerML);
            waterEl.style.height = `${height}px`;
            volumeReadout.textContent = isOverflowing ? '> OVERFLOW' : newTotalVolume.toFixed(1);
        }

        function updateTableMass(substance) {
            const row = document.querySelector(`#${substance.id.length > 1 ? 'known' : 'mystery'}-${substance.id}`);
            if (row) {
                row.querySelector('.mass-cell').textContent = substance.mass.toFixed(2);
                calculateDensity(row, substance.id.length > 1);
            }
        }

        function updateTableVolume(substance) {
            const row = document.querySelector(`#${substance.id.length > 1 ? 'known' : 'mystery'}-${substance.id}`);
            if (row) {
                 row.querySelector('.volume-cell').textContent = substance.volume.toFixed(2);
                 calculateDensity(row, substance.id.length > 1);
            }
        }
        
        function calculateDensity(row, isKnown) {
             if (isKnown) {
                const mass = parseFloat(row.querySelector('.mass-cell').textContent);
                const volume = parseFloat(row.querySelector('.volume-cell').textContent);
                const densityCell = row.querySelector('.density-cell');
                if (!isNaN(mass) && !isNaN(volume) && volume > 0) {
                    densityCell.textContent = (mass / volume).toFixed(2);
                }
             }
        }

        /**
         * Checks the answers for the mystery objects.
         * Provides detailed feedback for both density and substance name.
         */
        function checkMysteryAnswers() {
            mysteryObjects.forEach(obj => {
                const row = document.getElementById(`mystery-${obj.id}`);
                if (!row) return;

                const densityInput = row.querySelector('.density-input');
                const nameInput = row.querySelector('.substance-input');
                const resultCell = row.querySelector('.result-cell');

                const userDensity = parseFloat(densityInput.value);
                const userName = nameInput.value.trim().toLowerCase();
                
                const correctDensity = obj.density;
                const correctName = obj.name.toLowerCase();

                // Check density with a tolerance of +/- 0.1 to account for rounding
                const isDensityCorrect = !isNaN(userDensity) && Math.abs(userDensity - correctDensity) <= 0.1;
                const isNameCorrect = userName === correctName;

                // Reset borders
                densityInput.classList.remove('border-green-500', 'border-red-500');
                nameInput.classList.remove('border-green-500', 'border-red-500');

                if (isDensityCorrect && isNameCorrect) {
                    resultCell.innerHTML = `<span class="text-green-600 font-bold">✅ Correct!</span>`;
                    densityInput.classList.add('border-green-500');
                    nameInput.classList.add('border-green-500');
                } else {
                    let feedback = [];
                    // Provide feedback and border colors based on what is right or wrong
                    if (isDensityCorrect) {
                        densityInput.classList.add('border-green-500');
                    } else {
                        feedback.push('Density is incorrect.');
                        densityInput.classList.add('border-red-500');
                    }

                    if (isNameCorrect) {
                        nameInput.classList.add('border-green-500');
                    } else {
                        feedback.push('Substance name is incorrect.');
                        nameInput.classList.add('border-red-500');
                    }
                    resultCell.innerHTML = `<span class="text-red-600 font-bold">❌ ${feedback.join(' ')}</span>`;
                }
            });
        }

        // --- START THE APP ---
        init();
    });
</script>

</body>
</html>
